import os

def process_files(input_folder, output_file, delimiter=',', key_column_index=2):
    seen_keys = set()
    with open(output_file, 'w') as outfile:
        for file_name in os.listdir(input_folder):
            if file_name.endswith('.txt'):
                file_path = os.path.join(input_folder, file_name)
                with open(file_path, 'r') as infile:
                    for line in infile:
                        columns = line.strip().split(delimiter)
                        if len(columns) > key_column_index:
                            key = columns[key_column_index]
                            if key not in seen_keys:
                                outfile.write(line)
                                seen_keys.add(key)

# Usage example
input_folder = 'path_to_your_folder'
output_file = 'path_to_your_output_file.txt'
process_files(input_folder, output_file)