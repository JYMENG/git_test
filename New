import pandas as pd
from lxml import etree

def parse_xbrl_to_dataframe(xbrl_file):
    # Parse the XBRL file
    tree = etree.parse(xbrl_file)
    root = tree.getroot()

    # Define namespaces (these can vary depending on the XBRL instance)
    namespaces = {
        'xbrli': 'http://www.xbrl.org/2003/instance',
        'link': 'http://www.xbrl.org/2003/linkbase',
        # Add other namespaces as needed
    }

    # Extract data from XBRL
    data = []
    for element in root.iter():
        if element.tag.endswith('Item'):
            data.append({
                'name': element.tag.split('}')[1],
                'contextRef': element.get('contextRef'),
                'unitRef': element.get('unitRef'),
                'value': element.text,
            })

    # Create a DataFrame
    df = pd.DataFrame(data)

    return df

def save_to_excel(dataframe, excel_file):
    # Save DataFrame to Excel
    dataframe.to_excel(excel_file, index=False)

# Example usage
xbrl_file = 'example.xbrl'  # Replace with your XBRL file path
excel_file = 'output.xlsx'  # Replace with your desired Excel file path

df = parse_xbrl_to_dataframe(xbrl_file)
save_to_excel(df, excel_file)

print(f'XBRL data has been saved to {excel_file}')