Sub CreateChartsPerName()
    Dim wsData As Worksheet
    Dim wsDash As Worksheet
    Dim ptCache As PivotCache
    Dim pt As PivotTable
    Dim pc As PivotChart
    Dim tbl As ListObject
    Dim nameList As Collection
    Dim cell As Range, dataRng As Range
    Dim nameVal As String
    Dim topPos As Double, leftPos As Double
    Dim chartWidth As Double, chartHeight As Double
    Dim i As Long
    
    Set wsData = Worksheets("Sheet1") ' Change to your data sheet
    Set tbl = wsData.ListObjects("DataTbl")
    Set wsDash = Worksheets("ChartDashboard")
    wsDash.Cells.Clear ' Clear existing charts
    
    Set ptCache = ThisWorkbook.PivotCaches.Create( _
        SourceType:=xlDatabase, _
        SourceData:=tbl.Range.Address(, , , True))
    
    ' Get unique names
    Set nameList = New Collection
    On Error Resume Next
    For Each cell In tbl.ListColumns("name").DataBodyRange
        nameList.Add cell.Value, CStr(cell.Value)
    Next cell
    On Error GoTo 0

    ' Chart layout settings
    chartWidth = 300
    chartHeight = 200
    topPos = 10
    leftPos = 10
    i = 0

    ' Loop through each name and build chart
    For Each nameVal In nameList
        Dim ptName As String, chartName As String
        ptName = "PT_" & nameVal
        chartName = "CH_" & nameVal

        ' Add PivotTable
        Set pt = wsDash.PivotTables.Add(PivotCache:=ptCache, _
            TableDestination:=wsDash.Cells(1000 + i * 20, 1), TableName:=ptName)

        With pt
            .ClearAllFilters
            .PivotFields("name").CurrentPage = nameVal
            .PivotFields("date").Orientation = xlRowField
            .AddDataField .PivotFields("v1"), "v1", xlSum
            .AddDataField .PivotFields("v2"), "v2", xlSum
            .AddDataField .PivotFields("v3"), "v3", xlSum
            .PivotFields("class").Orientation = xlPageField
            .PivotFields("group").Orientation = xlPageField
        End With

        ' Create PivotChart
        Set pc = wsDash.Shapes.AddChart2(201, xlLine).Chart
        pc.SetSourceData pt.TableRange2
        pc.ChartTitle.Text = nameVal

        ' Position Chart
        With pc.Parent
            .Top = topPos + (Int(i / 2) * (chartHeight + 20))
            .Left = leftPos + ((i Mod 2) * (chartWidth + 20))
            .Width = chartWidth
            .Height = chartHeight
        End With

        i = i + 1
    Next nameVal

    MsgBox "Done! Created " & nameList.Count & " charts on '" & wsDash.Name & "'."
End Sub