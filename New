import xml.etree.ElementTree as ET
import xlsxwriter

def parse_xbrl(xbrl_file):
    tree = ET.parse(xbrl_file)
    root = tree.getroot()
    namespace = {
        'xbrli': 'http://www.xbrl.org/2003/instance'
    }

    fact_data = []

    for context in root.findall('.//xbrli:context', namespace):
        context_id = context.get('id')
        entity = context.find('.//xbrli:entity', namespace)
        identifier = entity.find('.//xbrli:identifier', namespace)
        scheme = identifier.get('scheme') if identifier is not None else ''

        for fact in root.findall(f".//*[@contextRef='{context_id}']"):
            concept = fact.tag.split('}')[-1]
            value = fact.text
            unit_ref = fact.attrib.get('unitRef', '')
            decimals = fact.attrib.get('decimals', '')
            precision = fact.attrib.get('precision', '')

            fact_data.append({
                'Concept': concept,
                'Value': value,
                'ContextRef': context_id,
                'Scheme': scheme,
                'Identifier': identifier.text if identifier is not None else '',
                'UnitRef': unit_ref,
                'Dec': decimals,
                'Prec': precision
            })

    return fact_data

def save_to_excel(fact_data, output_file):
    workbook = xlsxwriter.Workbook(output_file)
    worksheet = workbook.add_worksheet()

    headers = ['Concept', 'Value', 'ContextRef', 'Scheme', 'Identifier', 'UnitRef', 'Dec', 'Prec']
    for col, header in enumerate(headers):
        worksheet.write(0, col, header)

    for row, fact in enumerate(fact_data, start=1):
        worksheet.write(row, 0, fact['Concept'])
        worksheet.write(row, 1, fact['Value'])
        worksheet.write(row, 2, fact['ContextRef'])
        worksheet.write(row, 3, fact['Scheme'])
        worksheet.write(row, 4, fact['Identifier'])
        worksheet.write(row, 5, fact['UnitRef'])
        worksheet.write(row, 6, fact['Dec'])
        worksheet.write(row, 7, fact['Prec'])

    workbook.close()

xbrl_file = 'path/to/your/file.xbrl'
fact_data = parse_xbrl(xbrl_file)
save_to_excel(fact_data, 'output.xlsx')