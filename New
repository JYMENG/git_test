import sqlite3

# Connect to SQLite database
db_path = "C:/YourSQLiteDatabase.db"
conn = sqlite3.connect(db_path)
cursor = conn.cursor()

# Function to get column name by index
def get_column_name(table, index):
    cursor.execute(f"PRAGMA table_info({table})")
    columns = [row[1] for row in cursor.fetchall()]  # Get all column names
    return columns[index] if index < len(columns) else None  # Return column name or None

# Define tables and column indexes
table1, table2 = "Table1", "Table2"
col_index_1, col_index_2 = 2, 3  # Example: Compare Table1 column[2] with Table2 column[3]

# Get actual column names
col_name_1 = get_column_name(table1, col_index_1)
col_name_2 = get_column_name(table2, col_index_2)

if col_name_1 and col_name_2:
    # Construct query dynamically
    query = f"""
    SELECT {table1}.{col_name_1}, {table2}.{col_name_2} 
    FROM {table1}
    JOIN {table2} ON {table1}.{col_name_1} = {table2}.{col_name_2}
    """
    cursor.execute(query)

    # Fetch results
    rows = cursor.fetchall()
    for row in rows:
        print(row)
else:
    print("Invalid column index!")

conn.close()