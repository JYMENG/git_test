import csv

# File paths
file1_path = 'file1.csv'
file2_path = 'file2.csv'
output_path = 'joined_file.csv'

# Read file2 into a dictionary based on the key column
file2_data = {}
with open(file2_path, 'r') as file2:
    reader = csv.reader(file2, delimiter=',')  # Adjust delimiter if needed
    header2 = next(reader)  # Skip header
    for row in reader:
        key = row[0]  # Assuming the key column is the first column
        file2_data[key] = row

# Read file1 and select unique records based on the key column
file1_data = {}
with open(file1_path, 'r') as file1:
    reader = csv.reader(file1, delimiter=',')  # Adjust delimiter if needed
    header1 = next(reader)  # Skip header
    for row in reader:
        key = row[0]  # Assuming the key column is the first column
        file1_data[key] = row  # Keep only the unique records (duplicates will be overwritten)

# Join file1 (unique records) with file2 on the key column
joined_rows = []
joined_rows.append(header1 + header2[1:])  # Join headers

for key, row in file1_data.items():
    if key in file2_data:
        joined_row = row + file2_data[key][1:]  # Join data based on the key
        joined_rows.append(joined_row)

# Write the joined data to the output file
with open(output_path, 'w', newline='') as output_file:
    writer = csv.writer(output_file, delimiter=',')  # Adjust delimiter if needed
    writer.writerows(joined_rows)

print(f"Joined data written to {output_path}")