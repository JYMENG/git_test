Sub CombineXLSFiles()
    Dim FolderPath As String
    Dim FileName As String
    Dim wbDest As Workbook
    Dim wbSource As Workbook
    Dim ws As Worksheet
    Dim destSheet As Worksheet
    Dim LastRow As Long

    ' Set the folder path
    FolderPath = "C:\Your\Folder\Path\" ' Change this to your folder path

    ' Create a new workbook for the combined data
    Set wbDest = Workbooks.Add
    Set destSheet = wbDest.Sheets(1)

    ' Initialize the first row for data pasting
    LastRow = 1

    ' Loop through all .xls files in the folder
    FileName = Dir(FolderPath & "*.xls")
    Do While FileName <> ""
        ' Open the source workbook
        Set wbSource = Workbooks.Open(FolderPath & FileName)
        
        ' Loop through each sheet in the source workbook
        For Each ws In wbSource.Sheets
            ' Find the last row in the destination sheet
            LastRow = destSheet.Cells(destSheet.Rows.Count, 1).End(xlUp).Row + 1
            
            ' Copy the content from the source worksheet to the destination sheet
            ws.UsedRange.Copy
            destSheet.Cells(LastRow, 1).PasteSpecial Paste:=xlPasteValues
            
            ' Optionally, add the source workbook name and sheet name as headers
            destSheet.Cells(LastRow, 1).Value = FileName & " - " & ws.Name
            LastRow = LastRow + ws.UsedRange.Rows.Count
        Next ws

        ' Close the source workbook
        wbSource.Close SaveChanges:=False
        
        ' Move to the next file
        FileName = Dir
    Loop

    ' Save the destination workbook
    wbDest.SaveAs FolderPath & "CombinedData.xls"
    wbDest.Close

    MsgBox "All files have been successfully combined!", vbInformation
End Sub