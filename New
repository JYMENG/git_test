import pandas as pd
from datetime import datetime

# Parameters
input_file = "input.csv"  # Replace with your file name
output_file = "output.csv"  # Replace with desired output file name
non_blank_column = "ColumnA"  # Replace with the name of the non-blank column
date_column1 = "DateColumn1"  # Replace with the first date column name
date_column2 = "DateColumn2"  # Replace with the second date column name
id_column = "ID"  # Replace with the unique ID column name
specific_date = "2023-01-01"  # Replace with your specific date

# Load the file
df = pd.read_csv(input_file)

# Ensure the date columns are in datetime format, ignoring errors
df[date_column1] = pd.to_datetime(df[date_column1], errors="coerce")
df[date_column2] = pd.to_datetime(df[date_column2], errors="coerce")

# Filter rows
filtered_df = df[
    (df[non_blank_column].notna()) &  # Non-blank column
    (df[date_column1] > specific_date) &  # Date condition for DateColumn1
    (df[date_column2] > specific_date)  # Date condition for DateColumn2
]

# Get unique IDs from filtered rows
unique_ids = filtered_df[id_column].unique()

# Retrieve all rows that contain these unique IDs
result_df = df[df[id_column].isin(unique_ids)]

# Save the result to a file
result_df.to_csv(output_file, index=False)

print(f"Filtered data saved to {output_file}")