from pathlib import Path

def merge_visible_lines(folder, output_file, encoding="utf-8-sig"):
    folder_path = Path(folder)
    files = sorted(list(folder_path.glob("*.htm")) + list(folder_path.glob("*.html")))

    with open(output_file, "w", encoding=encoding, newline="") as outfile:
        for file in files:
            try:
                with open(file, "r", encoding=encoding, errors="replace") as infile:
                    for line in infile:
                        # Strip trailing newline to avoid double-spacing in output
                        outfile.write(line.rstrip("\n") + "\n")
            except Exception as e:
                print(f"[WARN] Skipped {file.name}: {e}")

    print(f"Done. Appended all visible lines from {len(files)} files into {output_file}")

# Example usage
merge_visible_lines(
    folder=r"C:\path\to\your\folder", 
    output_file=r"C:\path\to\output\merged.txt"
)