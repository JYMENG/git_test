Sub UnmergeAndCombineFiles()
    Dim FolderPath As String
    Dim FileName As String
    Dim SourceWorkbook As Workbook
    Dim TargetWorkbook As Workbook
    Dim TargetSheet As Worksheet
    Dim SourceSheet As Worksheet
    Dim LastRow As Long, LastCol As Long
    Dim DataRange As Range
    Dim TargetLastRow As Long

    ' Specify the folder path
    FolderPath = "C:\YourFolderPath\" ' Update with your folder path

    ' Set up the target workbook
    Set TargetWorkbook = ThisWorkbook
    Set TargetSheet = TargetWorkbook.Sheets(1)
    TargetLastRow = 1

    ' Get the first file in the folder starting with "IB"
    FileName = Dir(FolderPath & "IB*.xls*")
    
    ' Loop through all matching files
    Do While FileName <> ""
        ' Open the source workbook
        Set SourceWorkbook = Workbooks.Open(FolderPath & FileName)
        Set SourceSheet = SourceWorkbook.Sheets(1) ' Assuming data is in the first sheet
        
        ' Unmerge all cells
        SourceSheet.Cells.UnMerge

        ' Find the last row and column with data
        With SourceSheet
            LastRow = .Cells(.Rows.Count, 1).End(xlUp).Row
            LastCol = .Cells(5, .Columns.Count).End(xlToLeft).Column
        End With

        ' Copy data starting from row 5
        Set DataRange = SourceSheet.Range(SourceSheet.Cells(5, 1), SourceSheet.Cells(LastRow, LastCol))
        DataRange.Copy

        ' Paste data into the target sheet
        TargetSheet.Cells(TargetLastRow, 1).PasteSpecial Paste:=xlPasteValuesAndNumberFormats
        TargetLastRow = TargetSheet.Cells(TargetSheet.Rows.Count, 1).End(xlUp).Row + 1

        ' Close the source workbook
        SourceWorkbook.Close SaveChanges:=False
        
        ' Move to the next file
        FileName = Dir
    Loop

    ' Clean up
    Application.CutCopyMode = False
    MsgBox "Data combined successfully into " & TargetWorkbook.Name
End Sub