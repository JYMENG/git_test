Sub CreatePivotChartWithSlicers()
    Dim wsDash As Worksheet
    Dim ptCache As PivotCache
    Dim pt As PivotTable
    Dim ptRange As Range
    Dim ptSheet As Worksheet
    Dim chartObj As ChartObject
    Dim dashName As String
    Dim dateField As PivotField
    Dim classSlicer As Slicer
    Dim groupSlicer As Slicer
    Dim nameVal As String
    Dim i As Long
    Dim slicerCacheClass As SlicerCache
    Dim slicerCacheGroup As SlicerCache
    
    ' Define dashboard sheet name
    dashName = "ChartDashboard"
    
    ' Delete the existing dashboard sheet if it exists
    Application.DisplayAlerts = False
    On Error Resume Next
    Worksheets(dashName).Delete
    On Error GoTo 0
    Application.DisplayAlerts = True
    
    ' Create a new dashboard sheet at the front
    Set wsDash = Worksheets.Add(Before:=Worksheets(1))
    wsDash.Name = dashName
    
    ' Set data source and create PivotCache
    Set ptCache = ThisWorkbook.PivotCaches.Create( _
        SourceType:=xlDatabase, _
        SourceData:="DataTbl")
    
    ' Create the first PivotTable in the new sheet
    Set ptRange = wsDash.Cells(3, 1) ' Start from row 3
    Set pt = ptCache.CreatePivotTable( _
        TableDestination:=ptRange, _
        TableName:="PivotTable1")
    
    ' Set up PivotFields for the first PivotTable
    With pt
        ' Set Page Fields
        .PivotFields("class").Orientation = xlPageField
        .PivotFields("group").Orientation = xlPageField
        .PivotFields("name").Orientation = xlPageField
        
        ' Set Row Field
        .PivotFields("date").Orientation = xlRowField
        Set dateField = .PivotFields("date")
        
        ' Group the Date Field by 30 days
        dateField.Group Start:=True, End:=True, By:=Array(30)
        
        ' Set Data Fields (assuming v1, v2, v3 are numeric)
        .AddDataField .PivotFields("v1"), "Sum of v1", xlSum
        .AddDataField .PivotFields("v2"), "Sum of v2", xlSum
        .AddDataField .PivotFields("v3"), "Sum of v3", xlSum
    End With

    ' Create the first PivotChart
    Set chartObj = wsDash.ChartObjects.Add( _
        Left:=ptRange.Left + ptRange.Width + 20, _
        Top:=ptRange.Top, _
        Width:=500, Height:=300)
    chartObj.Chart.SetSourceData pt.TableRange2
    chartObj.Chart.ChartType = xlLine
    chartObj.Chart.HasTitle = True
    chartObj.Chart.ChartTitle.Text = "PivotChart for " & nameVal
    
    ' Change X-axis label interval to 30
    With chartObj.Chart.Axes(xlCategory)
        .MajorUnit = 30  ' Set major unit to 30 (this is the interval between X labels)
    End With
    
    ' Create the second PivotTable in the same sheet
    Set ptRange = wsDash.Cells(20, 1) ' Start below the first PivotTable
    Set pt = ptCache.CreatePivotTable( _
        TableDestination:=ptRange, _
        TableName:="PivotTable2")
    
    ' Set up PivotFields for the second PivotTable
    With pt
        ' Set Page Fields
        .PivotFields("class").Orientation = xlPageField
        .PivotFields("group").Orientation = xlPageField
        .PivotFields("name").Orientation = xlPageField
        
        ' Set Row Field
        .PivotFields("date").Orientation = xlRowField
        Set dateField = .PivotFields("date")
        
        ' Group the Date Field by 30 days
        dateField.Group Start:=True, End:=True, By:=Array(30)
        
        ' Set Data Fields (assuming v1, v2, v3 are numeric)
        .AddDataField .PivotFields("v1"), "Sum of v1", xlSum
        .AddDataField .PivotFields("v2"), "Sum of v2", xlSum
        .AddDataField .PivotFields("v3"), "Sum of v3", xlSum
    End With

    ' Create the second PivotChart
    Set chartObj = wsDash.ChartObjects.Add( _
        Left:=ptRange.Left + ptRange.Width + 20, _
        Top:=ptRange.Top, _
        Width:=500, Height:=300)
    chartObj.Chart.SetSourceData pt.TableRange2
    chartObj.Chart.ChartType = xlLine
    chartObj.Chart.HasTitle = True
    chartObj.Chart.ChartTitle.Text = "PivotChart for " & nameVal
    
    ' Change X-axis label interval to 30 for the second chart
    With chartObj.Chart.Axes(xlCategory)
        .MajorUnit = 30
    End With
    
    ' Create a common slicer for 'class'
    Set slicerCacheClass = ThisWorkbook.SlicerCaches.Add( _
        PivotTable:=pt, _
        Field:="class")
    Set classSlicer = wsDash.Slicers.Add( _
        SlicerCache:=slicerCacheClass, _
        Left:=250, Top:=50, Width:=100, Height:=200)
    classSlicer.Name = "Class Slicer"
    
    ' Create a common slicer for 'group'
    Set slicerCacheGroup = ThisWorkbook.SlicerCaches.Add( _
        PivotTable:=pt, _
        Field:="group")
    Set groupSlicer = wsDash.Slicers.Add( _
        SlicerCache:=slicerCacheGroup, _
        Left:=250, Top:=300, Width:=100, Height:=200)
    groupSlicer.Name = "Group Slicer"

    ' Connect slicers to both PivotTables
    slicerCacheClass.PivotTables.Add pt
    slicerCacheClass.PivotTables.Add pt
    
    slicerCacheGroup.PivotTables.Add pt
    slicerCacheGroup.PivotTables.Add pt
End Sub