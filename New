import pandas as pd
import glob
import os

# Set your folder path
folder_path = r'/path/to/your/folder'

# Get all .xlsx files
file_list = glob.glob(os.path.join(folder_path, '*.xlsx'))
file_list.sort()  # Optional: ensures consistent order

df_list = []
true_columns = None  # placeholder for header

for i, file in enumerate(file_list):
    if i == 0:
        # First file: read header from row 4
        df = pd.read_excel(file, skiprows=3)
        true_columns = df.columns.tolist()
    else:
        # Other files: skip header row and assign columns
        df = pd.read_excel(file, skiprows=4, header=None)
        df.columns = true_columns
    df_list.append(df)

# Concatenate all
combined_df = pd.concat(df_list, ignore_index=True)

# Save or preview
combined_df.to_excel('combined_output.xlsx', index=False)
print(combined_df.head())