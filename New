import pandas as pd

# File path
excel_file = "your_file.xlsx"

# Load workbook
xls = pd.ExcelFile(excel_file, engine="openpyxl")

# Read header from row 6 (index 5) of the first sheet
base_header_df = pd.read_excel(excel_file, sheet_name=xls.sheet_names[0], header=5, nrows=0, engine="openpyxl")
base_columns = list(base_header_df.columns)

# Container for all DataFrames
dataframes = []

# Read each sheet starting from row 7 (skiprows=6)
for sheet in xls.sheet_names:
    df = pd.read_excel(excel_file, sheet_name=sheet, skiprows=6, header=None, engine="openpyxl")
    if not df.empty:
        # Read actual headers from the sheet (in case it differs)
        current_header = pd.read_excel(excel_file, sheet_name=sheet, header=5, nrows=0, engine="openpyxl").columns
        df.columns = current_header  # Set current sheet's header
        dataframes.append(df)

# Combine all sheets, aligning columns
combined_df = pd.concat(dataframes, ignore_index=True, sort=True)

# Optional: ensure all base columns appear first, others follow
final_columns = base_columns + [col for col in combined_df.columns if col not in base_columns]
combined_df = combined_df[final_columns]

# Save to Excel
combined_df.to_excel("combined_output.xlsx", index=False)