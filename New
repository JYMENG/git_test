import pandas as pd

# File paths
file1_path = 'file1.csv'
file2_path = 'file2.csv'
output_path = 'joined_file.csv'

# Read the files into pandas DataFrames
df1 = pd.read_csv(file1_path)  # Adjust delimiter if needed
df2 = pd.read_csv(file2_path)  # Adjust delimiter if needed

# Select specific columns from df1 (e.g., only 'Key' and 'Name')
df1_filtered = df1[['Key', 'Name']]  # Replace 'Key' and 'Name' with the desired columns

# Select unique records from df1_filtered based on the key column
df1_unique = df1_filtered.drop_duplicates(subset='Key', keep='last')  # Keeps the last occurrence of each key

# Perform the join on the key column (assumed to be 'Key')
df_joined = pd.merge(df1_unique, df2, on='Key', how='inner')  # You can change 'inner' to 'left', 'right', etc.

# Write the joined DataFrame to the output file
df_joined.to_csv(output_path, index=False)

print(f"Joined data written to {output_path}")