import pandas as pd

# File paths
file1_path = 'file1.csv'  # Replace with your first file path
file2_path = 'file2.csv'  # Replace with your second file path
output_file_path = 'merged_output.csv'  # Output file path

# Define chunk size (adjust this based on your system's memory capacity)
chunksize = 50000  # Number of rows per chunk

# Initialize a flag to determine if the output file already exists (for headers)
output_exists = False

# Read the first file in chunks and process each chunk
for chunk1 in pd.read_csv(file1_path, chunksize=chunksize, encoding='ISO-8859-1'):
    # Read the second file in chunks
    for chunk2 in pd.read_csv(file2_path, chunksize=chunksize, encoding='ISO-8859-1'):
        # Perform the inner join (adjust 'on' parameter to your join key column)
        merged_chunk = pd.merge(chunk1, chunk2, on='ID', how='inner')

        # Write the result to the output file, append if file exists
        merged_chunk.to_csv(output_file_path, mode='a', header=not output_exists, index=False)
        output_exists = True  # After the first chunk, set header=False for subsequent chunks

    # You can break after the first pass of chunk2 if you only need one join for each chunk1
    break

print("Merging complete.")