import pandas as pd
from lxml import etree

# Load the XBRL file
xbrl_file = 'your_xbrl_file.xml'
tree = etree.parse(xbrl_file)
root = tree.getroot()

# Define namespaces (adjust according to your XBRL file)
namespaces = {
    'xbrli': 'http://www.xbrl.org/2003/instance',
    'us-gaap': 'http://fasb.org/us-gaap/2020-01-31'
}

# Extract data (adjust according to your XBRL file structure)
data = []
for element in root.findall('.//us-gaap:*', namespaces=namespaces):
    context_ref = element.get('contextRef')
    tag_name = etree.QName(element).localname
    value = element.text
    data.append({
        'context_ref': context_ref,
        'tag_name': tag_name,
        'value': value
    })

# Convert to DataFrame
df = pd.DataFrame(data)

# Save to Excel
df.to_excel('output.xlsx', index=False)