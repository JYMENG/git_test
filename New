
import pandas as pd
from datetime import datetime

input_file = 'your_large_file.csv'
output_file = 'filtered_output.csv'
date_column = 'my_field'  # column that contains dates and other junk

start_date = pd.to_datetime('2023-01-01')
end_date = pd.to_datetime('2024-12-31')

# Write header once
first_chunk = True

# Process in chunks
chunksize = 100_000  # adjust based on your memory
for chunk in pd.read_csv(input_file, chunksize=chunksize):
    # Try to convert the column to datetime, invalid ones become NaT
    chunk['parsed_date'] = pd.to_datetime(chunk[date_column], errors='coerce')

    # Filter for date range
    filtered = chunk[(chunk['parsed_date'] >= start_date) & (chunk['parsed_date'] <= end_date)]

    # Drop the helper column
    filtered.drop(columns=['parsed_date'], inplace=True)

    # Append to output
    filtered.to_csv(output_file, mode='a', index=False, header=first_chunk)
    first_chunk = False