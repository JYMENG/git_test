/* Define the path to the Excel file */
%let excel_file = C:\path\to\your\file.xlsx;

/* Create a macro to list all sheets */
%macro list_sheets(file=, out=);
    /* Use PROC IMPORT to get the sheet names */
    proc import datafile="&file"
        out=&out
        dbms=excelcs replace;
        sheet="";
        getnames=no;
    run;
%mend list_sheets;

/* Call the macro to list all sheets and store the output in a dataset */
%list_sheets(file=&excel_file, out=sheet_list);

/* Use a data step to create a macro variable for each sheet name */
data _null_;
    set sheet_list;
    call symputx(cats('sheet', _n_), sheet_name);
    call symputx('num_sheets', _n_);
run;

/* Create a macro to import each sheet into a separate dataset */
%macro import_sheets(file=, num_sheets=);
    %do i = 1 %to &num_sheets;
        %let sheet_name = &&sheet&i;
        
        proc import datafile="&file"
            out=sheet_&i
            dbms=excelcs replace;
            sheet="&sheet_name";
            getnames=yes;
        run;
    %end;
%mend import_sheets;

/* Call the macro to import each sheet */
%import_sheets(file=&excel_file, num_sheets=&num_sheets);