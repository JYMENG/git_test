import os
import csv

# Define the folder path, key column, and output file
folder_path = 'path_to_your_folder'
key_column = 'your_key_column_name'
output_path = 'merged_output.csv'

# Initialize a set to keep track of unique keys
seen_keys = set()

# Open the output file for writing
with open(output_path, 'w', newline='') as output_file:
    # Initialize CSV writer
    writer = csv.writer(output_file)
    
    # Get a list of all .txt files in the folder
    file_list = sorted([file for file in os.listdir(folder_path) if file.endswith('.txt')])
    
    # Iterate through each file
    for file_name in file_list:
        file_path = os.path.join(folder_path, file_name)
        
        # Open and read the current file
        with open(file_path, 'r', encoding='utf-8') as input_file:
            reader = csv.DictReader(input_file, delimiter=',')
            
            # Write header only if it's the first file
            if output_file.tell() == 0:
                writer.writerow(reader.fieldnames)
            
            # Process each row
            for row in reader:
                key = row[key_column]
                if key not in seen_keys:
                    seen_keys.add(key)
                    writer.writerow(row.values())  # Write the row to the output file

print(f"Merged file saved as {output_path}")