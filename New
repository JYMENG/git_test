function Test-Recursive {
    param (
        [int]$Depth,
        [System.Collections.Generic.List[object]]$Collector
    )

    if ($Depth -le 0) {
        return
    }

    $Collector.Add([PSCustomObject]@{
        Depth = $Depth
        Message = "Level $Depth"
    })

    Test-Recursive -Depth ($Depth - 1) -Collector $Collector
}

# Prepare safe collector
$collected = [System.Collections.Generic.List[object]]::new()
Test-Recursive -Depth 3 -Collector $collected

# Show preview
$collected | Format-Table
$collected[0].GetType().FullName