import os

# Specify the folder path and output file path
folder_path = 'path_to_your_folder'
output_file = 'output_file.txt'

# Function to process a single file
def process_file(filepath, output):
    with open(filepath, 'r') as infile:
        prev_line = None
        for line in infile:
            line = line.strip()  # Remove leading and trailing whitespace
            if prev_line:
                combined_line = prev_line + line
                if combined_line.count(',') < 44:
                    prev_line = combined_line
                else:
                    output.write(prev_line + '\n')
                    prev_line = line
            else:
                prev_line = line
        if prev_line:
            output.write(prev_line + '\n')  # Write any remaining line

# Open the output file in write mode
with open(output_file, 'w') as outfile:
    # Iterate over all files in the folder
    for filename in os.listdir(folder_path):
        if filename.endswith('.txt'):
            filepath = os.path.join(folder_path, filename)
            process_file(filepath, outfile)