import pandas as pd

file_path = 'your_file.csv'
output_path = 'filtered_output.csv'
key_columns = ['id', 'date']
chunksize = 100_000  # Tune based on your memory

# Initialize write mode with headers
first_chunk = True

for chunk in pd.read_csv(file_path, chunksize=chunksize):
    # Drop rows where any key column is NaN or empty
    chunk = chunk.dropna(subset=key_columns)
    chunk = chunk[(chunk[key_columns] != '').all(axis=1)]

    # Append to output
    chunk.to_csv(output_path, mode='a', header=first_chunk, index=False)
    first_chunk = False