import json
import pandas as pd

# Read one line from the text file
with open("data.txt", "r", encoding="utf-8") as f:
    line = f.readline().strip()

# Split by "|"
parts = line.split("|")

# First 3 fields
field1, field2, field3 = parts[:3]

# Parse JSON (last part)
json_str = parts[3]
json_data = json.loads(json_str)

# Flatten into rows
rows = []
for item in json_data:
    row = {
        "Field1": field1,
        "Field2": field2,
        "Field3": field3,
        **item
    }
    rows.append(row)

# Convert to DataFrame
df = pd.DataFrame(rows)

# Write to Excel
df.to_excel("output.xlsx", index=False)

print("Excel file 'output.xlsx' created.")